<% thumb =
  if product.images.attached?
    product.images.first.variant(resize_to_limit: [600, 600])
  end
%>

<div id="<%= dom_id(product, :card) %>"
     class="w-full max-w-sm bg-white border border-gray-400 rounded-lg shadow-sm flex flex-col h-full overflow-hidden">

  <%= link_to product_path(product) do %>
    <div class="mx-auto mt-2 h-48 w-full flex items-center justify-center border border-gray-300 rounded-md bg-white">
      <% if thumb %>
        <%= image_tag thumb,
              class: "h-44 object-contain",
              alt: t(".product_image_alt", title: product.title) %>
      <% else %>
        <%= image_tag "placeholder.png",
              class: "h-44 object-contain",
              alt: t(".placeholder_image_alt") %>
      <% end %>
    </div>
  <% end %>

  <div class="px-4 pb-4 pt-3 flex-1 flex flex-col gap-3">
    <%= link_to product_path(product) do %>
      <h3 class="text-base font-semibold text-slate-900 line-clamp-2">
        <%= product.title %>
      </h3>
    <% end %>

    <div class="mt-auto flex items-center justify-between gap-3">
      <span class="text-xl font-bold text-slate-900">
        Â¥<%= number_to_currency(product.price, unit: "", precision: 0) %>
      </span>

      <%= form_with url: create_cart_item_path(product),
                    method: :post,
                    local: true,
                    class: "flex items-center gap-2" do |f| %>
        <%= number_field_tag "cart_item[quantity]", 1, min: 1,
              class: "w-16 rounded-md border border-gray-300 px-2 py-1 text-sm
                      focus:outline-none focus:ring-2 focus:ring-orange-500" %>

        <%= f.submit t(".add_to_cart"),
              class: "btn btn-primary" %>
      <% end %>
    </div>
  </div>
</div>
